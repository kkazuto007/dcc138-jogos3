<!DOCTYPE html>
<html lang="pt">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Knight of Toyland</title>
    <link rel="stylesheet" type="text/css" href="css/estilo.css" />
    <script src="Sprite.js"></script>
    <script src="Scene.js"></script>
    <script src="AssetsManager.js"></script>
    <script src="Map.js"></script>

</head>

<body>
    <canvas></canvas>
    <script>
        var assetsMng = new AssetsManager();
        var mapAssets = new AssetsManager();

        mapAssets.loadImage("castle","./assets/castle.png");
        assetsMng.loadImage("bear","./assets/main/bear.png");


        mapAssets.loadImage("toyroom1","./assets/toyroom/toyroom1.png");
        mapAssets.loadImage("toyroom2","./assets/toyroom/toyroom2.png");
        mapAssets.loadImage("toyroom3","./assets/toyroom/toyroom3.png");
        mapAssets.loadImage("toytiles","./assets/toyroom/toytiles.png");
        assetsMng.loadImage("seeker","./assets/toyroom/seeker.png");


        mapAssets.loadImage("pleiades","./assets/pleiades.jpg");
        mapAssets.loadImage("toyblocks","./assets/toyblocks.png");
        mapAssets.loadImage("rocket","./assets/rocket.png");
        mapAssets.loadImage("text1","./assets/rocket.png");

        var canvas = document.querySelector("canvas");
        canvas.width = 800;
        canvas.height = 640;

        var ctx = canvas.getContext("2d");
        var teclas = {
            esquerda: 0,
            cima: 0,
            direita: 0,
            baixo: 0,
            espaco: 0
        }


        var mapas = [];
        var mapa0 = new Map({mapindice: 0, COLUMNS:26, LINES:20, m:
        [
        [1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1],
        [1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1],
        [1,  1,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  1],
        [1,  1,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  1],
        [1,  1,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  1],
        [1,  1,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  1],
        [1,  1,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  1],
        [1,  1,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  1],
        [1,  1,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  1],
        [1,  1,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  1],
        [1,  1,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  1],
        [1,  1,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  1],
        [1,  1,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  2,  2,  2,  2,  0,  0,  0,  0,  0,  0,  1],
        [1,  1,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0,  2,  2,  0,  0,  2,  0,  0,  0,  0,  2,  2,  1],
        [1,  1,  1,  0,  0,  0,  0,  0,  0,  0,  0,  2,  2,  2,  0,  0,  2,  0,  0,  0,  0,  0,  0,  1],
        [1,  1,  1,  0,  0,  0,  0,  0,  0,  0,  2,  2,  2,  2,  0,  0,  2,  0,  0,  0,  0,  0,  0,  1],
        [1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1],
        [1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1],
        [1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1],
        [1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1],
        ]
        });

        var mapa1 = new Map({mapindice: 1, COLUMNS:26, LINES:20,
        m:
        [
        [1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1],
        [1,  1,  1,  1,  0,  0,  0,  0,  0,  0,  0,  0,  3,  0,  0,  0,  0,  0,  0,  0,  0,  1,  1,  1],
        [1,  1,  1,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  1,  1,  1],
        [1,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  1],
        [1,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  1],
        [1,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  1],
        [1,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  1],
        [1,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  1],
        [1,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  1],
        [1,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  1],
        [1,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  1],
        [1,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  1],
        [1,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  1],
        [1,  1,  1,  0,  0,  1,  1,  1,  1,  0,  0,  1,  1,  1,  1,  0,  0,  1,  1,  1,  1,  0,  0,  1],
        [1,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  1],
        [1,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  1],
        [1,  1,  1,  1,  1,  1,  1,  0,  1,  1,  1,  1,  1,  0,  1,  1,  1,  1,  1,  0,  1,  1,  1,  1],
        [1,  1,  1,  1,  1,  1,  1,  0,  1,  1,  1,  1,  1,  0,  1,  1,  1,  1,  1,  0,  1,  1,  1,  1],
        [1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1],
        [1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1],
        ]})

        var mapa2 = new Map({mapindice: 2, COLUMNS:26, LINES:20,
        m:
        [
        [1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1],
        [1,  1,  2,  2,  0,  0,  0,  0,  0,  0,  2,  2,  2,  2,  2,  0,  0,  0,  0,  0,  0,  2,  2,  1],
        [1,  1,  2,  2,  0,  0,  0,  0,  0,  0,  2,  2,  2,  2,  2,  0,  0,  0,  0,  0,  0,  2,  2,  1],
        [1,  1,  0,  0,  0,  0,  0,  0,  0,  0,  2,  2,  2,  2,  2,  0,  0,  0,  0,  0,  0,  0,  0,  1],
        [1,  1,  0,  0,  0,  0,  0,  0,  0,  0,  2,  2,  2,  2,  2,  0,  0,  0,  0,  0,  0,  0,  0,  1],
        [1,  1,  0,  0,  0,  0,  0,  0,  0,  0,  2,  2,  2,  2,  2,  0,  0,  0,  0,  0,  0,  0,  0,  1],
        [1,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  1],
        [1,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  1],
        [1,  1,  0,  0,  0,  0,  0,  0,  0,  0,  2,  2,  2,  2,  2,  0,  0,  0,  0,  0,  0,  0,  0,  1],
        [1,  1,  0,  0,  0,  0,  0,  0,  0,  0,  2,  2,  2,  2,  2,  0,  0,  0,  0,  0,  0,  0,  0,  1],
        [1,  1,  0,  0,  0,  0,  0,  0,  0,  0,  2,  2,  2,  2,  2,  0,  0,  0,  0,  0,  0,  0,  0,  1],
        [1,  1,  0,  0,  0,  0,  0,  0,  0,  0,  2,  2,  2,  2,  2,  0,  0,  0,  0,  0,  0,  0,  0,  1],
        [1,  1,  0,  0,  0,  0,  0,  0,  0,  0,  2,  2,  2,  2,  2,  0,  0,  0,  0,  0,  0,  0,  0,  1],
        [1,  1,  0,  0,  0,  0,  0,  0,  0,  0,  2,  2,  2,  2,  2,  0,  0,  0,  0,  0,  0,  0,  0,  1],
        [1,  1,  0,  0,  0,  0,  0,  0,  0,  0,  2,  2,  2,  2,  2,  0,  0,  0,  0,  0,  0,  0,  0,  1],
        [1,  1,  0,  0,  0,  0,  0,  0,  0,  0,  2,  2,  2,  2,  2,  0,  0,  0,  0,  0,  0,  0,  0,  1],
        [1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1],
        [1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1],
        [1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1],
        [1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1],
        ]})

        var mapa3 = new Map({mapindice: 3, COLUMNS:26, LINES:20, m:
        [
        [1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1],
        [1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1],
        [1,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  1],
        [1,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  1,  1,  1,  1,  1,  1,  1,  1,  0,  1],
        [1,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  1],
        [1,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  1,  1,  1,  1,  1,  1,  1,  1,  0,  1],
        [1,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  1],
        [1,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  1],
        [1,  1,  0,  0,  0,  0,  1,  1,  1,  1,  0,  0,  0,  0,  1,  1,  1,  1,  1,  1,  1,  1,  0,  1],
        [1,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  1],
        [1,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  1],
        [1,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  1],
        [1,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  1,  1,  1,  0,  0,  0,  0,  0,  0,  1],
        [1,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  1,  1,  1,  0,  0,  0,  0,  0,  0,  1],
        [1,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  1,  1,  1,  1,  1,  1,  0,  0,  0,  0,  0,  1],
        [1,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  1,  1,  1,  1,  1,  1,  0,  0,  0,  0,  0,  1],
        [1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1],
        [1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1],
        [1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1],
        [1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1],
        ]
        })
        var mapa4 = new Map({mapindice: 4, COLUMNS:26, LINES:20, m:
        [
        [1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1],
        [1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1],
        [1,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  1,  1],
        [1,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  2,  2,  0,  0,  0,  0,  0,  1,  1],
        [1,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  2,  2,  2,  0,  0,  0,  0,  0,  1,  1],
        [1,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  2,  2,  2,  2,  0,  0,  0,  0,  0,  1,  1],
        [1,  1,  0,  2,  0,  0,  2,  0,  0,  2,  0,  0,  2,  2,  2,  2,  2,  0,  0,  0,  0,  0,  1,  1],
        [1,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  2,  2,  2,  0,  0,  0,  0,  0,  1,  1],
        [1,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  2,  2,  0,  0,  0,  0,  0,  1,  1],
        [1,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  2,  2,  0,  0,  0,  0,  0,  1,  1],
        [1,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  2,  2,  0,  0,  0,  0,  0,  1,  1],
        [1,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  2,  2,  0,  0,  0,  0,  0,  1,  1],
        [1,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  2,  2,  0,  0,  0,  0,  0,  1,  1],
        [1,  1,  0,  0,  0,  1,  1,  1,  1,  0,  0,  0,  0,  0,  2,  2,  2,  2,  2,  2,  2,  2,  2,  1],
        [1,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  2,  2,  2,  2,  2,  2,  2,  2,  2,  2,  2,  1],
        [1,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  2,  2,  2,  2,  2,  2,  2,  2,  2,  2,  2,  1],
        [1,  1,  1,  1,  1,  1,  1,  0,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1],
        [1,  1,  1,  1,  1,  1,  1,  0,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1],
        [1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1],
        [1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1],
        ]
        });

        mapa0.assets = mapAssets;
        mapa1.assets = mapAssets;
        mapa2.assets = mapAssets;

        mapas.push(mapa0);
        mapas.push(mapa1);
        mapas.push(mapa2);
        mapas.push(mapa3);
        mapas.push(mapa4);

        var cena1 = new Scene({ ctx: ctx, w: canvas.width, h: canvas.height, assets: mapAssets, map:mapas });
        var cena2 = new Scene({ ctx: ctx, w: canvas.width, h: canvas.height, assets: assetsMng, map:mapas });

        var pc = new Sprite({ x: 120, y: 440, w:24, h: 24, vx: 20,vy: 20, comportar: porTeclasDirecionais(teclas), props: { tipo: "pc" }});
        cena2.adicionar(pc);
         

        

        var npc2 = new Sprite({ x: 480, y: 300, w:32, h: 32, props: { tipo: "npc" }, comportar: charge(pc)});
        cena2.adicionar(npc2);

        var npc3 = new Sprite({ x: 480, y: 300, w:32, h: 32, props: { tipo: "npc" }, comportar: dialogo(pc)});
        cena2.adicionar(npc3);

        ///Flutuante com perseguiçao eterna após chegar perto
        function flutuante(alvo) {
           return function () {
               if(Math.sqrt((alvo.x - this.x)*(alvo.x - this.x)) + (alvo.y-this.y)*(alvo.y-this.y) <= 320){
                  this.comportamentoativo = 1;
               }
               if(this.comportamentoativo >= 1){
                  this.ax = 80*Math.sign(alvo.x - this.x);
                  this.ay = 80*Math.sign(alvo.y - this.y)- 980;
               }
            }
        }

        ///Corre em direção enquanto está perto
        function charge(alvo) {
           return function () {
               if(Math.sqrt((alvo.x - this.x)*(alvo.x - this.x)) +(alvo.y-this.y)*(alvo.y-this.y) <= 200){
                 this.ax = 200*Math.sign(alvo.x - this.x);
               }
            }
        }

        function dialogo(alvo) {
           return function () {
               if(Math.sqrt((alvo.x - this.x)*(alvo.x - this.x)) +(alvo.y-this.y)*(alvo.y-this.y) <= 200){
                 ctx.drawImage(mapAssets.img("text1"),
                 0,
                 0,
                 480,
                 100,
                 0,
                 0,
                 canvas.width,
                 100);
               }
            }
        }


        function restricao_generica_distancia(alvo) {
           return function () {
               if(Math.sqrt((alvo.x - this.x)*(alvo.x - this.x)) +(alvo.y-this.y)*(alvo.y-this.y) <= 200){
               }
            }
        }


        function spawner_generico_com_persegue2 (alvo) {
            return function () {
               this.ax = 20*Math.sign(alvo.x - this.x);
               this.ay = 20*Math.sign(alvo.y - this.y);
               this.cooldown = this.cooldown - dt;
               if(this.cooldown <= 0){
                   var tiro = new Sprite({
                       x: this.x,
                       y: this.y,
                       w: 32,
                       h: 32,
                       comportar: persegue2(alvo),
                       props: { tipo: "bossshot"},
                    });
                   var rng = Math.floor(Math.random()*100)%4;
                   var angel = new Sprite({
                       x: this.x,
                       y: this.y,
                       w: 32,
                       h: 32,
                       a: 0,
                       va: 2,
                       comportar: orbita(this,rng),
                       props: { tipo: "bossshot2"},
                    });
                    this.scene.adicionar(tiro);
                    this.scene.adicionar(angel);
                    this.cooldown = 5;
                }
            }
        }


        function porTeclasDirecionais(teclas) {
            return function () {
                if (teclas.esquerda) { this.ax = -300, this.lado = 0; }
                if (teclas.direita) { this.ax = +300, this.lado = 1; }
                if (teclas.esquerda === teclas.direita) { this.ax = 0; }

                if (teclas.cima && this.cooldown <=0) { this.cooldown = 0.75; this.vy = -500;  }
                if ( this.pulo >= 0.5) { this.pulo = 0, this.vy = -800;  }
                if (teclas.cima === teclas.baixo) { this.ay = 0; }

                if (teclas.espaco && this.cooldown <= 0) {
                    var tiro = new Sprite({
                        x: this.x, y: this.y-8,
                        a: this.a - 0.1 + 0.2 * Math.random(),
                        w: 64, h: 64,
                        props: { tipo: "tiro" }
                    });
                    this.scene.adicionar(tiro);
                }
            }
        }
        addEventListener("keydown", function (e) {
            switch (e.keyCode) {
                case 32:
                    teclas.espaco = 1;
                    menu = 1;
                    break;
                case 37:
                    teclas.esquerda = 1;
                    this.lado = 0;
                    break;
                case 38:
                    teclas.cima = 1;
                    break;
                case 39:
                    teclas.direita = 1;
                    this.lado = 1;
                    break;
                case 40:
                    teclas.baixo = 1;
                    break;
            }
        });
        addEventListener("keyup", function (e) {
            switch (e.keyCode) {
                case 32:
                    teclas.espaco = 0;
                    break;
                case 37:
                    teclas.esquerda = 0;
                    break;
                case 38:
                    teclas.cima = 0;
                    break;
                case 39:
                    teclas.direita = 0;
                    break;
                case 40:
                    teclas.baixo = 0;
                    break;
            }
        });

        function passo(t) { 
            ctx.clearRect(0,0, canvas.width, canvas.height);
            ctx.save();
            dt = (t - anterior) / 1000;
            
        //    if(assetsMng.progresso()===100){
               cena1.passo(dt);
               cena2.passo(dt);
          //  }
            anterior = t;
            requestAnimationFrame(passo);
            ctx.restore();
        }

        var dt, anterior = 0;
        requestAnimationFrame(passo);


    </script>
</body>

</html>
